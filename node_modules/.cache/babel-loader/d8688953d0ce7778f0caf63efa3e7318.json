{"ast":null,"code":"import _regeneratorRuntime from\"/Users/marina/Frontend/projects/js-react-projects/goit-react-hw-08-phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/marina/Frontend/projects/js-react-projects/goit-react-hw-08-phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import actions from'./auth-actions';axios.defaults.baseURL='https://connections-api.herokuapp.com';var token={set:function set(token){axios.defaults.headers.common.Authorization=\"Bearer \".concat(token);},unset:function unset(){axios.defaults.headers.common.Authorization='';}};export var register=function register(credentials){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var _yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(actions.registerRequest());_context.prev=1;_context.next=4;return axios.post('/users/signup',credentials);case 4:_yield$axios$post=_context.sent;data=_yield$axios$post.data;token.set(data.token);dispatch(actions.registerSuccess(data));_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);dispatch(actions.registerError(_context.t0.message));case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,10]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var logIn=function logIn(credentials){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var _yield$axios$post2,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(actions.loginRequest());_context2.prev=1;_context2.next=4;return axios.post('/users/login',credentials);case 4:_yield$axios$post2=_context2.sent;data=_yield$axios$post2.data;token.set(data.token);dispatch(actions.loginSuccess(data));_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);dispatch(actions.loginError(_context2.t0.message));case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[1,10]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logOut=function logOut(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(actions.logoutRequest());_context3.prev=1;_context3.next=4;return axios.post('/users/logout');case 4:token.unset();dispatch(actions.logoutSuccess());_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](1);dispatch(actions.logoutError(_context3.t0.message));case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[1,8]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var getCurrentUser=function getCurrentUser(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch,getState){var _getState,persistedToken,_yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_getState=getState(),persistedToken=_getState.auth.token;if(persistedToken){_context4.next=3;break;}return _context4.abrupt(\"return\");case 3:token.set(persistedToken);dispatch(actions.getCurrentUserRequest());_context4.prev=5;_context4.next=8;return axios.get('/users/current');case 8:_yield$axios$get=_context4.sent;data=_yield$axios$get.data;dispatch(actions.getCurrentUserSuccess(data));_context4.next=16;break;case 13:_context4.prev=13;_context4.t0=_context4[\"catch\"](5);dispatch(actions.getCurrentUserError(_context4.t0.message));case 16:case\"end\":return _context4.stop();}}},_callee4,null,[[5,13]]);}));return function(_x4,_x5){return _ref4.apply(this,arguments);};}();};","map":{"version":3,"sources":["/Users/marina/Frontend/projects/js-react-projects/goit-react-hw-08-phonebook/src/redux/auth/auth-operations.js"],"names":["axios","actions","defaults","baseURL","token","set","headers","common","Authorization","unset","register","credentials","dispatch","registerRequest","post","data","registerSuccess","registerError","message","logIn","loginRequest","loginSuccess","loginError","logOut","logoutRequest","logoutSuccess","logoutError","getCurrentUser","getState","persistedToken","auth","getCurrentUserRequest","get","getCurrentUserSuccess","getCurrentUserError"],"mappings":"mYAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAEA,MAAOC,CAAAA,OAAP,KAAoB,gBAApB,CAEAD,KAAK,CAACE,QAAN,CAAeC,OAAf,CAAyB,uCAAzB,CAEA,GAAMC,CAAAA,KAAK,CAAG,CACZC,GADY,cACRD,KADQ,CACD,CACTJ,KAAK,CAACE,QAAN,CAAeI,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,kBAAwDJ,KAAxD,EACD,CAHW,CAIZK,KAJY,iBAIJ,CACNT,KAAK,CAACE,QAAN,CAAeI,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,CAA8C,EAA9C,CACD,CANW,CAAd,CASA,MAAO,IAAME,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAAC,WAAW,iGAAI,iBAAMC,QAAN,6IACrCA,QAAQ,CAACX,OAAO,CAACY,eAAR,EAAD,CAAR,CADqC,sCAIZb,CAAAA,KAAK,CAACc,IAAN,CAAW,eAAX,CAA4BH,WAA5B,CAJY,wCAI3BI,IAJ2B,mBAI3BA,IAJ2B,CAMnCX,KAAK,CAACC,GAAN,CAAUU,IAAI,CAACX,KAAf,EAEAQ,QAAQ,CAACX,OAAO,CAACe,eAAR,CAAwBD,IAAxB,CAAD,CAAR,CARmC,iFAUnCH,QAAQ,CAACX,OAAO,CAACgB,aAAR,CAAsB,YAAMC,OAA5B,CAAD,CAAR,CAVmC,qEAAJ,gEAA5B,CAcP,MAAO,IAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAAAR,WAAW,kGAAI,kBAAMC,QAAN,kJAClCA,QAAQ,CAACX,OAAO,CAACmB,YAAR,EAAD,CAAR,CADkC,wCAITpB,CAAAA,KAAK,CAACc,IAAN,CAAW,cAAX,CAA2BH,WAA3B,CAJS,0CAIxBI,IAJwB,oBAIxBA,IAJwB,CAMhCX,KAAK,CAACC,GAAN,CAAUU,IAAI,CAACX,KAAf,EAEAQ,QAAQ,CAACX,OAAO,CAACoB,YAAR,CAAqBN,IAArB,CAAD,CAAR,CARgC,qFAUhCH,QAAQ,CAACX,OAAO,CAACqB,UAAR,CAAmB,aAAMJ,OAAzB,CAAD,CAAR,CAVgC,uEAAJ,kEAAzB,CAcP,MAAO,IAAMK,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,mGAAM,kBAAMX,QAAN,sHAC1BA,QAAQ,CAACX,OAAO,CAACuB,aAAR,EAAD,CAAR,CAD0B,wCAIlBxB,CAAAA,KAAK,CAACc,IAAN,CAAW,eAAX,CAJkB,QAMxBV,KAAK,CAACK,KAAN,GACAG,QAAQ,CAACX,OAAO,CAACwB,aAAR,EAAD,CAAR,CAPwB,mFASxBb,QAAQ,CAACX,OAAO,CAACyB,WAAR,CAAoB,aAAMR,OAA1B,CAAD,CAAR,CATwB,sEAAN,kEAAf,CAaP,MAAO,IAAMS,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,mGAAM,kBAAOf,QAAP,CAAiBgB,QAAjB,mLAG9BA,QAAQ,EAHsB,CAEjBC,cAFiB,WAEhCC,IAFgC,CAExB1B,KAFwB,IAI7ByB,cAJ6B,mEAQlCzB,KAAK,CAACC,GAAN,CAAUwB,cAAV,EAEAjB,QAAQ,CAACX,OAAO,CAAC8B,qBAAR,EAAD,CAAR,CAVkC,wCAYT/B,CAAAA,KAAK,CAACgC,GAAN,CAAU,gBAAV,CAZS,wCAYxBjB,IAZwB,kBAYxBA,IAZwB,CAahCH,QAAQ,CAACX,OAAO,CAACgC,qBAAR,CAA8BlB,IAA9B,CAAD,CAAR,CAbgC,qFAehCH,QAAQ,CAACX,OAAO,CAACiC,mBAAR,CAA4B,aAAMhB,OAAlC,CAAD,CAAR,CAfgC,uEAAN,sEAAvB","sourcesContent":["import axios from 'axios';\n\nimport actions from './auth-actions';\n\naxios.defaults.baseURL = 'https://connections-api.herokuapp.com';\n\nconst token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\n  },\n  unset() {\n    axios.defaults.headers.common.Authorization = '';\n  },\n};\n\nexport const register = credentials => async dispatch => {\n  dispatch(actions.registerRequest());\n\n  try {\n    const { data } = await axios.post('/users/signup', credentials);\n\n    token.set(data.token);\n\n    dispatch(actions.registerSuccess(data));\n  } catch (error) {\n    dispatch(actions.registerError(error.message));\n  }\n};\n\nexport const logIn = credentials => async dispatch => {\n  dispatch(actions.loginRequest());\n\n  try {\n    const { data } = await axios.post('/users/login', credentials);\n\n    token.set(data.token);\n\n    dispatch(actions.loginSuccess(data));\n  } catch (error) {\n    dispatch(actions.loginError(error.message));\n  }\n};\n\nexport const logOut = () => async dispatch => {\n  dispatch(actions.logoutRequest());\n\n  try {\n    await axios.post('/users/logout');\n\n    token.unset();\n    dispatch(actions.logoutSuccess());\n  } catch (error) {\n    dispatch(actions.logoutError(error.message));\n  }\n};\n\nexport const getCurrentUser = () => async (dispatch, getState) => {\n  const {\n    auth: { token: persistedToken },\n  } = getState();\n  if (!persistedToken) {\n    return;\n  }\n\n  token.set(persistedToken);\n\n  dispatch(actions.getCurrentUserRequest());\n  try {\n    const { data } = await axios.get('/users/current');\n    dispatch(actions.getCurrentUserSuccess(data));\n  } catch (error) {\n    dispatch(actions.getCurrentUserError(error.message));\n  }\n};\n"]},"metadata":{},"sourceType":"module"}